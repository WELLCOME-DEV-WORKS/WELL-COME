<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link rel="stylesheet" href="../static/css/reForeginCorporation.css" />
</head>

<body>
  <div class="fc-nav-container">
    <div class="fc-mo-grid-container">
      <div id="fc-nav-moLogo">
        <a href="https://well-come.info">WELL-COME</a>
      </div>
      <div id="fc-nev-dropdown">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </div>
      <div id="fc-dropMenu-container" class="fc-hidden move-out">
        <div class="fc-serviceTitle">외국인 서비스</div>
        <div class="fc-dropMenu-line"></div>
        <div class="fc-dropMenu" id="fc-dropMenu-1">
          <a href="https://well-come.info/">외국인 취업</a>
        </div>
        <div class="fc-dropMenu" id="fc-dropMenu-2">
          <a href="https://well-come.info/corporate-visa">외국인 창업비자</a>
        </div>
        <div class="fc-dropMenu" id="fc-dropMenu-3">
          <a href="https://well-come.info/incorporation">외국인 법인설립</a>
        </div>
        <div class="fc-serviceTitle">기업 서비스</div>
        <div class="fc-dropMenu-line"></div>
        <div class="fc-dropMenu" id="fc-dropMenu-4">
          <a href="#">서비스 문의</a>
        </div>

        <div id="fc-nav-moLogo">
          <a href="https://well-come.info">WELL-COME</a>
          <div>서울시 마포구 마포대로 78<br />자람빌딩 11층 1113,1115호</div>
          <div>1551-8016</div>
        </div>
      </div>
    </div>

    <div class="fc-grid-container">
      <div class="fc-nav-logo" id="fc-nav-topLogo">
        <a href="https://well-come.info">WELL-COME</a>
      </div>
      <div class="fc-nav-menu-container">
        <div></div>
        <div></div>
        <div class="fc-topMenu" id="fc-topMenu-1">
          <a href="https://well-come.info/incorporation">법인설립</a>
        </div>
        <div class="fc-topMenu active" id="fc-topMenu-2">
          <a class="fc-active" href="https://well-come.info/corporate-visa">창업비자</a>
        </div>
      </div>
    </div>
  </div>
  <div class="fc-fullSection-container">
    <div class="fc-mainSection">
      <div class="fc-multiDisplaySection-form">
        <!-- 폼 섹션 시작 -->
        <section class="fc-form-multiStep active" id="fc-userEduAbility">
          <div class="fc-scoreDisplay" id="scoreDisplay"></div>
          <div class="fc-form-title">请选择 韩国人/外国人</div>
          <div class="fc-userEduCountry">
            <div class="fc-radio-SelectBox" data-edu="내국인">
              <input type="radio" name="education_level" value="내국인" />
              <img src="https://cdn.imweb.me/thumbnail/20240822/17ae2878ffff8.png" />
              韩国人
            </div>
            <div class="fc-radio-SelectBox" data-edu="외국인">
              <input type="radio" name="education_level" value="외국인" />
              <img src="https://cdn.imweb.me/thumbnail/20240822/736184391d2cb.png" />
              外国人
            </div>
          </div>
          <div class="fc-activeControlBox">
            <div class="fc-nextButton deactiveted">下一步</div>
          </div>
        </section>

        <section class="fc-form-multiStep" id="fc-">
          <div class="fc-scoreDisplay" id="scoreDisplay"></div>
          <div class="fc-form-title">居住地区</div>
          <div class="fc-radio-SelectBox" data-value="한국 거주">
            <input type="radio" name="education_level" value="한국 거주" />
            韩国
          </div>
          <div class="fc-radio-SelectBox" data-value="해외 거주">
            <input type="radio" name="education_level" value="해외 거주" />
            海外
          </div>
          <div class="fc-activeControlBox">
            <div class="fc-prevButton">上一步</div>
            <div class="fc-nextButton deactiveted">下一步</div>
          </div>
        </section>

        <section class="fc-form-multiStep" id="fc-intellectualPropertyRights">
          <div class="fc-scoreDisplay" id="scoreDisplay"></div>
          <div class="fc-form-title">请选择注册公司的类型</div>
          <div class="fc-radio-SelectBox" data-value="주식회사">
            <input type="radio" name="education_level" value="주식회사" />
            股份公司
          </div>
          <div class="fc-radio-SelectBox" data-value="유한책임회사">
            <input type="radio" name="education_level" value="유한책임회사" />
            责任有限公司
          </div>
          <div class="fc-radio-SelectBox" data-value="유한회사">
            <input type="radio" name="education_level" value="유한회사" />
            有限公司
          </div>
          <div class="fc-activeControlBox">
            <div class="fc-prevButton">上一步</div>
            <div class="fc-nextButton deactiveted">下一步</div>
          </div>
        </section>

        <section class="fc-form-multiStep" id="fc-intellectualPropertyRights-sub">
          <div class="fc-scoreDisplay" id="scoreDisplay"></div>
          <div class="fc-form-title">请选择公司设立地区</div>
          <select name="intellectual_property" class="fc-dropdown" id="regionSelect">
            <option value="">选择 市/道</option>
            <option value="서울특별시">首尔特别市</option>
            <option value="인천광역시">仁川广域市</option>
            <option value="경기도">京畿道</option>
            <option value="강원특별자치도">江原特别自治道 </option>
            <option value="충청북도">忠清北道 </option>
            <option value="충청남도">忠清南道 </option>
            <option value="전라북도">全罗北道 </option>
            <option value="전라남도">全罗南道 </option>
            <option value="경상북도">庆尚北道</option>
            <option value="경상남도">庆尚南道</option>
            <option value="부산광역시">釜山广域市</option>
            <option value="대구광역시">大邱广域市</option>
            <option value="울산광역시">蔚山广域市</option>
            <option value="광주광역시">光州广域市</option>
            <option value="대전광역시">大田广域市</option>
            <option value="세종특별자치시">世宗特別自治市</option>
            <option value="제주특별자치도">济州特别自治道</option>
          </select>

          <select class="fc-dropdown" id="subRegionSelect">
            <option value="">选择 市/区</option>
          </select>


          <div class="fc-activeControlBox">
            <div class="fc-prevButton">上一步</div>
            <div class="fc-nextButton deactiveted">下一步</div>
          </div>
        </section>

        <section class="fc-form-multiStep" id="fc-isCorporationEstablished">
          <div class="fc-scoreDisplay" id="scoreDisplay"></div>
          <div class="fc-form-title">请填写法人姓名</div>
          <input type="text" class="fc-formButton" placeholder="法人姓名" />
          <div class="fc-activeControlBox">
            <div class="fc-prevButton">上一步</div>
            <div class="fc-nextButton deactiveted">下一步</div>
          </div>
        </section>

        <section class="fc-form-multiStep" id="fc-isCorporationEstablished-sub">
          <div class="fc-scoreDisplay" id="scoreDisplay"></div>
          <div class="fc-form-title">请填写姓名</div>
          <input type="text" class="fc-formButton" placeholder="姓名" />

          <div class="fc-activeControlBox">
            <div class="fc-prevButton">上一步</div>
            <div class="fc-nextButton deactiveted">下一步</div>
          </div>
        </section>

        <section class="fc-form-multiStep" id="fc-isCorporationEstablished-sub">
          <div class="fc-scoreDisplay" id="scoreDisplay"></div>
          <div class="fc-form-title">请填写联系方式</div>
          <input type="text" class="fc-formButton" placeholder="联系电话" />

          <div class="fc-activeControlBox">
            <div class="fc-prevButton">上一步</div>
            <div class="fc-finishButton deactiveted" onclick="submitInfo()">提交</div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <section class="fc-warringModal">
    <div class="fc-warringModal-content">
      <div class="fc-warringModal-title">警告</div>
      <div class="fc-warringModal-message"></div>
      <div class="fc-warringModal-button">确认</div>
    </div>
  </section>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const nextButtons = document.querySelectorAll(".fc-nextButton");
      const prevButtons = document.querySelectorAll(".fc-prevButton");
      const steps = document.querySelectorAll(".fc-form-multiStep");

      let currentStep = 0;

      // 초기 단계에서 로컬 스토리지 초기화
      if (currentStep === 0) {
        localStorage.clear();
      }

      // 주어진 인덱스에 해당하는 단계만 보이도록 설정
      function showStep(index) {
        steps.forEach((step, i) => {
          step.classList.toggle("active", i === index);
        });
      }

      // 경고 팝업을 표시하는 함수
      function warringPopup(message) {
        const warringModal = document.querySelector(".fc-warringModal");
        const warringMessage = document.querySelector(
          ".fc-warringModal-message"
        );
        const warringButton = document.querySelector(".fc-warringModal-button");

        warringMessage.textContent = message;
        warringModal.style.display = "flex";
        warringButton.addEventListener("click", () => {
          warringModal.style.display = "none";
        });
      }

      // 현재 단계에 대한 유효성 검사
      function validateStep() {
        const validationRules = [
          {
            step: 0,
            message: "请选择国家",
            selector: 'input[name="education_level"]:checked', // 라디오 버튼 체크 확인
          },
          {
            step: 1,
            message: "请选择居住国家",
            selector: "#fc-userKoreanTestLevel .fc-formButton.selected",
          },
          {
            step: 2,
            message: "请选择公司类型",
            selector: "#fc-intellectualPropertyRights .fc-formButton.selected",
          },
          {
            step: 3,
            message: "请选择公司设立地区",
            selector: "#fc-patent .fc-formButton.selected",
          },
          {
            step: 4,
            message: "请输入法人姓名",
            selector: "#fc-isCorporationEstablished .fc-formButton.selected",
          },
          {
            step: 5,
            message: "请填写姓名.",
            selector: "#fc-isCorporationEstablished-sub .fc-formButton.selected",
          },
          {
            step: 6,
            message: "请填写联系方式",
            selector: "#fc-isCorporationEstablished-sub .fc-formButton.selected",
          },
        ];

        const rule = validationRules[currentStep];
        const storedValue = localStorage.getItem(`${currentStep} selectedValue`)
        // 카드 기반 유효성 검사 및 입력 필드 검사 통합
        if (!storedValue) {
          console.log('유효성 체크');
          warringPopup(rule.message); // 경고 메시지 표시
          return false; // 유효성 검사 실패
        }
        return true; // 유효성 검사 통과
      }



      // 설립 지역 데이터 리스트

      // 카드 클릭 이벤트 추가
      const radioSelectBoxes = document.querySelectorAll('.fc-radio-SelectBox');
      radioSelectBoxes.forEach(box => {
        box.addEventListener('click', handleCardClick); // 카드 클릭 시 이벤트 핸들러 추가
      });

      // 카드 클릭 이벤트 핸들러
      function handleCardClick(event) {
        const selectedRadioValue = event.currentTarget.querySelector('input[type="radio"]');
        highlightSelectedCard(event.currentTarget); // 카드 강조 처리
        if (selectedRadioValue) {
          saveSelectedValue(selectedRadioValue.value); // 로컬 스토리지에 값 저장
        }
      }

      // 카드 강조 처리 함수
      function highlightSelectedCard(clickedCard) {
        // 모든 카드에서 'selected' 클래스 제거
        radioSelectBoxes.forEach(box => {
          box.classList.remove('selected');
        });

        // 클릭된 카드에 'selected' 클래스 추가
        clickedCard.classList.add('selected');
      }

      // 로컬 스토리지에 값 저장 함수
      function saveSelectedValue(value) {
        saveToLocalStorage(`${currentStep} selectedValue`, value);
      }

      // 로컬 스토리지에 값 저장
      function saveToLocalStorage(key, value) {
        localStorage.setItem(key, value);
        console.log(localStorage); // 저장된 로컬 스토리지 확인
      }

      // 다음 단계로 이동하는 함수
      const goToNextStep = () => {
        const currentStepElement = steps[currentStep];

        if (!validateStep()) {
          return; // 유효성 검사 실패 시 종료
        }

        currentStepElement.classList.remove("active");


        currentStep += 1; // 다음 단계로 이동

        if (currentStep < steps.length) {
          steps[currentStep].classList.add("active");
        }


      }



      // input text 추가 이벤트
      const textSelectBoxes = document.querySelectorAll('.fc-formButton');
      textSelectBoxes.forEach((input) => {
        input.addEventListener('input', (e) => {
          const value = e.target.value;
          const placeholder = input.placeholder;

          saveToLocalStorage(`${currentStep} selectedValue`, value);

          console.log(`Saved ${placeholder}: ${value}`); // 저장된 값 확인용
        });
      });

      // 다음 버튼 클릭 시 goToNextStep 호출
      nextButtons.forEach((button) => {
        button.addEventListener("click", goToNextStep);

      });

      // 이전 버튼 클릭 시 이전 단계로 이동
      prevButtons.forEach((button) => {
        button.addEventListener("click", () => {
          if (currentStep > 0) {
            currentStep--;
            showStep(currentStep);
          }
        });
      });

      // 초기 단계 표시
      showStep(currentStep);



      // 하위 주소 로직
      let areaList = {
        "서울특별시": {
          "name": "서울특별시",
          "subRegions": {
            "강남구": "江南区",
            "강북구": "江北区",
            "강서구": "江西区",
            "관악구": "冠岳区",
            "광진구": "广津区",
            "구로구": "九老区",
            "금천구": "衿川区",
            "노원구": "芦原区",
            "도봉구": "道峰区",
            "동대문구": "东大门区",
            "동작구": "铜雀区",
            "마포구": "麻浦区",
            "서대문구": "西大门区",
            "서초구": "瑞草区",
            "성동구": "城东区",
            "성북구": "城北区",
            "송파구": "松坡区",
            "양천구": "阳川区",
            "영등포구": "永登浦区",
            "용산구": "龙山区",
            "은평구": "恩平区",
            "종로구": "钟路区",
            "중구": "中区",
            "중랑구": "中浪区"
          }
        },

        "경기도": {
          "name": "경기도",
          "subRegions": {
            "고양시": "高阳市",
            "과천시": "果川市",
            "광명시": "光明市",
            "구리시": "广州市",
            "구리시": "九里市",
            "군포시": "军浦市",
            "김포시": "金浦市",
            "남양주시": "南杨州市",
            "동두천시": "东豆川市",
            "부천시": "富川市",
            "성남시": "城南市",
            "수원시": "水原市",
            "시흥시": "始兴市",
            "안산시": "安山市",
            "안성시": "安城市",
            "안양시": "安养市",
            "양주시": "杨州市",
            "이천시": "骊州市",
            "오산시": "乌山市",
            "용인시": "龙仁市",
            "의왕시": "义王市",
            "의정부시": "议政府市",
            "이천시": "利川市",
            "파주시": "坡州市",
            "평택시": "平泽市",
            "포천시": "抱川市",
            "하남시": "河南市",
            "화성시": "华城市"
          }
        },
        "강원특별자치도": {
          "name": "강원특별자치도",
          "subRegions": {
            "강릉시": "江陵市",
            "동해시": "东海市",
            "삼척시": "三陟市",
            "속초시": "束草市",
            "원주시": "原州市",
            "춘천시": "春川市",
            "태백시": "太白市"
          }
        },
        "충청북도": {
          "name": "충청북도",
          "subRegions": {
            "제천시": "堤川市",
            "청주시": "清州市",
            "충주": "忠州市"
          }
        },
        "충청남도": {
          "name": "충청남도",
          "subRegions": {
            "계룡시": "鸡龙市",
            "공주시": "公州市",
            "논산시": "论山市",
            "당진시": "唐津市",
            "보령시": "保宁市",
            "서산시": "瑞山市",
            "아산시": "牙山市",
            "천안시": "天安市"
          }
        },
        "전라북도": {
          "name": "전라북도",
          "subRegions": {
            "군산시": "群山市",
            "김제시": "金堤市",
            "남원시": "南原市",
            "익산시": "益山市",
            "전주시": "全州市",
            "정읍시": "井邑市"
          }
        },
        "전라남도": {
          "name": "전라남도",
          "subRegions": {
            "광양시": "光阳市",
            "여수시": "罗州市",
            "목포시": "木浦市",
            "순천시": "顺天市",
            "여수시": "丽水市"
          }
        },
        "경상북도": {
          "name": "경상북도",
          "subRegions": {
            "경산시": "庆山市",
            "경주": "庆州市",
            "구미시": "龟尾市",
            "김천시": "金泉市",
            "문경시": "闻庆市",
            "상주": "尚州市",
            "안동시": "安东市",
            "영주": "荣州市",
            "영천시": "永川市",
            "포항시": "浦项市"
          }
        },
        "경상남도": {
          "name": "경상남도",
          "subRegions": {
            "김해시": "金海市",
            "밀양시": "密阳市",
            "사천시": "泗川市",
            "양산시": "梁山市",
            "진주시": "晋州市",
            "창원시": "昌原市",
            "통영시": "统营市"
          }
        },
        "부산광역시": {
          "name": "부산광역시",
          "subRegions": {
            "없음": "无"
          }
        },
        "대구광역시": {
          "name": "대구광역시",
          "subRegions": {
            "없음": "无"
          }
        },
        "울산광역시": {
          "name": "울산광역시",
          "subRegions": {
            "없음": "无"
          }
        },
        "광주광역시": {
          "name": "광주광역시",
          "subRegions": {
            "없음": "无"
          }
        },
        "대전광역시": {
          "name": "대전광역시",
          "subRegions": {
            "없음": "无"
          }
        },
        "세종특별자치시": {
          "name": "세종특별자치시",
          "subRegions": {
            "없음": "无"
          }
        },
        "제주특별자치도": {
          "name": "제주특별자치도",
          "subRegions": {
            "서귀포시": "西归浦市",
            "제주시": "济州市"
          }
        }


      };

      const updateSubRegion = () => {
        let regionSelect = document.getElementById("regionSelect");
        let selectedRegionValue = regionSelect.value;
        let subRegionSelect = document.getElementById("subRegionSelect");
        let selectedRegionIndex = regionSelect.selectedIndex;
        let selectedRegion = regionSelect.options[selectedRegionIndex].value; // value 사용
        console.log('regionSelect =>', regionSelect);
        console.log('selectedRegion =>', selectedRegion);


        // 하위 지역 초기화
        subRegionSelect.innerHTML = '<option value="">选择 市/区</option>';

        if (selectedRegion) {
          let subRegions = areaList[selectedRegion]?.subRegions; // subRegions 가져오기
          console.log('subRegions =>', subRegions);


          // 하위 지역이 없음인 경우
          // if (!subRegions || Object.keys(subRegions).length === 0 || subRegions["无"]) {
          //   let option = document.createElement("option");
          //   option.value = "无";
          //   option.textContent = "无";
          //   subRegionSelect.appendChild(option);
          //   subRegionSelect.value = "无";
          // } else {
          // 하위 지역 추가
          for (let subRegion in subRegions) {
            let option = document.createElement("option");
            option.value = subRegion; // 하위 지역의 원래 이름
            option.textContent = subRegions[subRegion]; // 하위 지역의 한국어 이름
            subRegionSelect.appendChild(option);
          }
          // }

          // 하위 지역 선택 시 이벤트 처리
          subRegionSelect.onchange = () => {
            console.log('하위지역');
            let selectedSubRegion = subRegionSelect.value;
            console.log('Selected sub-region saved to localStorage:', selectedSubRegion);
          };

          saveRegionValue(); // 지역 값 저장 함수 호출
        }
      };

      const regionSelect = document.getElementById("regionSelect");
      regionSelect.addEventListener("change", updateSubRegion);

      const saveRegionValue = () => {
        const regionSelect = document.getElementById("regionSelect");
        const subRegionSelect = document.getElementById("subRegionSelect");

        let selectedRegionIndex = regionSelect.selectedIndex;
        let selectedRegion = regionSelect.options[selectedRegionIndex].value; // 선택된 시/도

        subRegionSelect.onchange = () => {
          let selectedSubRegion = subRegionSelect.value; // 선택된 시/구

          console.log('selectedRegion =>', selectedRegion);
          console.log('selectedSubRegion =>', selectedRegion);

          // 주소1(시/도)와 주소2(시/구)를 합칩니다.
          let fullAddress = selectedRegion + ' ' + selectedSubRegion;
          console.log('fullAddress', fullAddress);

          // 로컬 스토리지에 저장
          saveSelectedValue(fullAddress);

          console.log('Selected full address saved to localStorage:', fullAddress);
        };

      }
    });

    function submitInfo() {
      console.log('submitInfo');
      const submitLimit = localStorage.getItem('6 selectedValue')

      if (submitLimit && submitLimit.length >= 2) {
        document.getElementById("input_txt_2adc34665cda5").value =
          localStorage.getItem('0 selectedValue')
        document.getElementById("input_txt_79cacd4241db5").value =
          localStorage.getItem('1 selectedValue')
        document.getElementById("input_txt_D44y508KH2").value =
          localStorage.getItem('2 selectedValue')
        document.getElementById("input_txt_186pTBK084").value =
          localStorage.getItem('3 selectedValue')
        document.getElementById("input_txt_1RBdDI3aF0").value =
          localStorage.getItem('4 selectedValue')
        document.getElementById("input_txt_T53Ny7dP83").value =
          localStorage.getItem('5 selectedValue')
        document.getElementById("input_txt_6vvJcU7o8Q").value =
          localStorage.getItem('6 selectedValue')
        SITE_FORM.confirmInputForm('w202409197a6d11485bedb', 'N');
        localStorage.clear();
      }
    }


  </script>

</body>

</html>