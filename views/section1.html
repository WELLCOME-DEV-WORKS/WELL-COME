<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>section1</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        height: 200vh;
      }

      /* 섹션 1 */
      .section1 {
        width: 100%;
        height: 100%;
        position: fixed;
        transition: opacity 0.5s ease;
      }

      .img-row {
        display: flex;
        width: 80%;
        align-items: center;
        justify-content: center;
      }

      /* 이미지 공통 스타일 */
      img.img {
        width: 660px;
        height: auto;
        flex-shrink: 0;
        position: relative;
        box-shadow: 5px 5px 14px #0000007c;
      }

      /* 여권 이미지별 스타일 */
      img.passport1 {
        transform: rotate(-8.515deg);
        z-index: 3;
        left: 170px;
        top: -280px;
      }
      img.passport2 {
        transform: rotate(28.515deg);
        z-index: 2;
        left: 140px;
        top: -200px;
      }

      img.passport3 {
        transform: rotate(-8.104deg);
        z-index: 1;
        right: -300px;
        top: -10px;
      }

      img.passport4 {
        transform: rotate(17.104deg);
        z-index: 5;
        left: 50px;
        bottom: 600px;
      }

      img.passport5 {
        transform: rotate(-30.104deg);
        z-index: 4;
        left: 200px;
        bottom: 700px;
      }

      /* 여권 애니메이션 */
      @keyframes moveTo10 {
        to {
          transform: translate(-100vw, -100vh);
          opacity: 0;
        }
      }

      @keyframes moveTo12 {
        to {
          transform: translateY(-100vh);
          opacity: 0;
        }
      }

      @keyframes moveTo3 {
        to {
          transform: translateX(100vw);
          opacity: 0;
        }
      }

      @keyframes moveTo8 {
        to {
          transform: translate(-100vw, 100vh);
          opacity: 0;
        }
      }

      @keyframes moveTo5 {
        to {
          transform: translate(100vw, 100vh);
          opacity: 0;
        }
      }

      /* 섹션 2 */
      .section2 {
        opacity: 0;
        width: 100%;
        height: 100%;
        position: fixed;
        transition: opacity 0.5s ease;
      }

      .why-list {
        list-style-type: none;
        margin: 0;
        padding: 0;
      }

      .why-item {
        list-style: none;
        background-color: rgb(154, 208, 178);
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        align-items: center;
        height: 20vh;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <section class="section1">
      <div class="img-row">
        <img
          src="../static/img/Korea.svg"
          alt="passport3"
          class="img passport1"
          id="passport-img-1"
        />
        <img
          src="../static/img/China.svg"
          alt="passport1"
          class="img passport2"
          id="passport-img-2"
        />
        <img
          src="../static/img/Japan.svg"
          alt="passport2"
          class="img passport3"
          id="passport-img-3"
        />
      </div>
      <div class="img-row">
        <img
          src="../static/img/USA.svg"
          alt="passport4"
          class="img passport4"
          id="passport-img-4"
        />
        <img
          src="../static/img/Vietnam.svg"
          alt="passport5"
          class="img passport5"
          id="passport-img-5"
        />
      </div>
    </section>
    <section class="section2">
      <ul class="why-list">
        <li class="why-item">why1</li>
        <li class="why-item">why2</li>
        <li class="why-item">why3</li>
        <li class="why-item">why4</li>
        <li class="why-item">why5</li>
      </ul>
    </section>

    <script>
      const passportImages = document.querySelectorAll('img');
      const section1 = document.querySelector('.section1');
      const section2 = document.querySelector('.section2');
      let scrollTriggered = false; // 애니메이션 실행 여부

      section2.style.display = 'none'; // section2는 처음에 보이지 않음

      // 스크롤 이벤트
      window.addEventListener('scroll', function () {
        const currentScrollY = window.scrollY;

        // 스크롤 다운 시 애니메이션 실행 후 section2 전환
        if (currentScrollY > 50 && !scrollTriggered) {
          passportImages.forEach((img, index) => {
            resetAnimation(img);
            moveImage(img, 'normal', index === passportImages.length - 1); // 마지막 이미지에 애니메이션 종료 이벤트 추가
          });
          scrollTriggered = true;
        }

        // 스크롤 업 시 section2에서 section1으로 전환 후 애니메이션 reverse 실행
        if (currentScrollY <= 50 && scrollTriggered) {
          transitionToSection1(() => {
            passportImages.forEach((img, index) => {
              resetAnimation(img);
              moveImage(img, 'reverse', index === 0); // 첫 번째 이미지에 애니메이션 종료 이벤트 추가
            });
          });
          scrollTriggered = false;
        }
      });

      // 이미지 이동 함수
      function moveImage(img, direction, triggerTransition) {
        const duration = '1.5s';
        const animationName =
          img.id === 'passport-img-1'
            ? 'moveTo10'
            : img.id === 'passport-img-2'
            ? 'moveTo12'
            : img.id === 'passport-img-3'
            ? 'moveTo3'
            : img.id === 'passport-img-4'
            ? 'moveTo8'
            : 'moveTo5';

        img.style.animation = `${animationName} ${duration} forwards`;
        img.style.animationDirection =
          direction === 'reverse' ? 'reverse' : 'normal';

        // 애니메이션 끝나면 section2로 전환 (스크롤 내릴 때)
        if (triggerTransition && direction === 'normal') {
          img.addEventListener('animationend', transitionToSection2, {
            once: true,
          });
        }
      }

      // 애니메이션을 다시 적용할 수 있도록 초기화
      function resetAnimation(img) {
        img.style.animation = 'none';
        img.offsetHeight; // 강제로 리플로우 발생
        img.style.animation = '';
      }

      // Section 2로 전환 함수
      function transitionToSection2() {
        section1.style.opacity = '0';
        setTimeout(() => {
          section1.style.display = 'none';
          section2.style.display = 'block';
          setTimeout(() => {
            section2.style.opacity = '1';
          }, 5);
        }, 5);
      }

      // Section 1로 복귀 함수 (전환 후 애니메이션 reverse 실행)
      function transitionToSection1(afterTransitionCallback) {
        section2.style.opacity = '0';
        setTimeout(() => {
          section2.style.display = 'none';
          section1.style.display = 'block';
          setTimeout(() => {
            section1.style.opacity = '1';
            afterTransitionCallback(); // Section1 복귀 후 애니메이션 reverse 실행
          }, 5);
        }, 5);
      }
    </script>
  </body>
</html>
